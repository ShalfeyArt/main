<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Шалфей — Творческая мастерская</title>
    <link rel="icon" href="https://raw.githubusercontent.com/ShalfeyArt/main/refs/heads/main/shalfey.ico" type="image/x-icon">
    
    <!-- Подключение Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Шрифты -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Иконки -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Firebase SDK (Modular) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA8roOb63vM_ZaBt11x8B1b132gQBiG29A",
            authDomain: "shalf-aad46.firebaseapp.com",
            projectId: "shalf-aad46",
            storageBucket: "shalf-aad46.firebasestorage.app",
            messagingSenderId: "131850620388",
            appId: "1:131850620388:web:1afd6733af73f96af0cbf1",
            measurementId: "G-XN22P9DJBZ"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Авторизация для доступа к БД
        signInAnonymously(auth).then(() => {
            console.log("Connected to Firebase anonymously");
            loadContent();
        }).catch((error) => {
            console.error("Auth Error", error);
        });

        // Функция загрузки контента
        async function loadContent() {
            const sections = ['rentals', 'workshops', 'handmade'];
            
            for (const section of sections) {
                const container = document.getElementById(`${section}-container`);
                if (!container) continue;

                // Очистка контейнера (кроме статических элементов, если есть)
                container.innerHTML = '<div class="col-span-full text-center py-10"><i class="fas fa-spinner fa-spin text-3xl text-sage-green"></i></div>';

                try {
                    const q = query(collection(db, "products"), where("category", "==", section)); // Можно добавить orderBy("createdAt") если добавить поле даты
                    const querySnapshot = await getDocs(q);
                    
                    container.innerHTML = ''; // Убираем спиннер

                    if (querySnapshot.empty) {
                        container.innerHTML = '<div class="col-span-full text-center text-gray-500 italic">В этом разделе пока пусто...</div>';
                        return;
                    }

                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        const cardHTML = createCardHTML(data, section);
                        container.insertAdjacentHTML('beforeend', cardHTML);
                    });

                    // Инициализация слайдеров после добавления элементов в DOM
                    initializeCardSliders();
                    // Инициализация анимации появления
                    runAnimations(container);

                } catch (error) {
                    console.error(`Error loading ${section}:`, error);
                    container.innerHTML = '<div class="col-span-full text-center text-red-400">Не удалось загрузить данные. Проверьте соединение.</div>';
                }
            }
        }

        // Генерация HTML карточки
        function createCardHTML(item, type) {
            // Обработка изображений (массив или строка)
            let images = Array.isArray(item.images) ? item.images : [item.images || 'https://via.placeholder.com/400x500?text=No+Image'];
            if (images.length === 0) images = ['https://via.placeholder.com/400x500?text=No+Image'];

            // Слайды
            const slidesHTML = images.map((img, index) => 
                `<div class="slide ${index === 0 ? 'active' : ''}"><img src="${img}" alt="${item.title}" class="w-full h-full object-cover"></div>`
            ).join('');

            // Точки навигации
            const dotsHTML = images.length > 1 ? `
                <div class="dots-container flex justify-center space-x-2 mb-4">
                    ${images.map((_, index) => `<button class="dot w-2.5 h-2.5 bg-gray-300 rounded-full ${index === 0 ? 'active' : ''}"></button>`).join('')}
                </div>` : '<div class="mb-4"></div>'; // Пустой блок для отступа

            // Кнопки навигации
            const navButtonsHTML = images.length > 1 ? `
                <button class="slider-prev absolute top-1/2 left-2 transform -translate-y-1/2 bg-white/60 hover:bg-white rounded-full p-2 shadow-md transition z-10"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
                <button class="slider-next absolute top-1/2 right-2 transform -translate-y-1/2 bg-white/60 hover:bg-white rounded-full p-2 shadow-md transition z-10"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></button>
            ` : '';

            // Цена и действие
            let priceBlock = '';
            let actionButton = '';

            if (type === 'rentals') {
                priceBlock = `
                    <div class="mt-4">
                        <p class="text-lg font-bold text-sage-green">Стоимость аренды:</p>
                        <p class="text-gray-600">${item.price}</p>
                    </div>`;
            } else if (type === 'workshops') {
                priceBlock = `<p class="font-bold text-xl text-sage-green mt-3">Стоимость: ${item.price} руб.</p>`;
                actionButton = `<button class="mt-4 bg-sage-green text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-90 transition-colors" onclick="window.prepareOrder('${item.title}', 'Мастер-класс')">Записаться</button>`;
            } else {
                priceBlock = `<p class="mt-4 text-xl font-bold text-sage-green">Цена: ${item.price} руб.</p>`;
            }

            // Обертка отличается для Workshops (горизонтальная) и остальных (вертикальная)
            if (type === 'workshops') {
                return `
                <div data-animate="fade-up" class="flex flex-col md:flex-row items-center gap-8 bg-white p-8 rounded-lg shadow-md mb-8">
                    <div class="w-full md:w-1/3 h-64 relative rounded-lg overflow-hidden group">
                         <div class="card-slider-container w-full h-full" data-slider-id="${Math.random().toString(36).substr(2, 9)}">
                            ${slidesHTML}
                            ${navButtonsHTML}
                         </div>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-3xl font-handwritten text-gray-800">${item.title}</h3>
                        <p class="text-gray-600 my-3">${item.description}</p>
                        ${priceBlock}
                        ${actionButton}
                    </div>
                </div>`;
            } else {
                return `
                <div data-animate="zoom-in" class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col h-full">
                    <div class="card-slider-container h-80 relative" data-slider-id="${Math.random().toString(36).substr(2, 9)}">
                        ${slidesHTML}
                        ${navButtonsHTML}
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        ${dotsHTML}
                        <h4 class="text-2xl font-handwritten font-bold text-gray-800">${item.title}</h4>
                        <p class="text-gray-600 mt-2 flex-grow">${item.description}</p>
                        ${priceBlock}
                    </div>
                </div>`;
            }
        }

        // Глобальная функция для открытия формы заказа (для кнопок)
        window.prepareOrder = (title, type) => {
            // Скролл к форме контактов или открытие модалки (здесь используем скролл к форме аренды как универсальной или создадим скрытые поля)
            const rentalSection = document.getElementById('rentals');
            showPage('rentals'); // Переключаем на вкладку с формой
            
            // Заполняем поле "Костюм" или создаем универсальное поле
            const costumeInput = document.querySelector('input[name="costume"]');
            if(costumeInput) {
                costumeInput.value = `${type}: ${title}`;
                costumeInput.focus();
            }
        };

        // Отправка заказа в Firestore
        window.submitOrder = async (event, formId, type) => {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            data.type = type; // 'rentals' или 'contact'
            data.status = 'new';
            data.createdAt = new Date().toISOString();

            const btn = form.querySelector('button[type="submit"]');
            const originalText = btn.innerText;
            btn.innerText = "Отправка...";
            btn.disabled = true;

            try {
                // Сохраняем в Firebase
                await addDoc(collection(db, "orders"), data);
                
                // Показываем уведомление
                showNotification("Ваша заявка успешно отправлена! Мы скоро свяжемся с вами.");
                
                // Опционально: Отправка в телеграм (как раньше)
                // const tgMessage = `Новый заказ (${type}):\n${JSON.stringify(data, null, 2)}`;
                // redirectToTelegram(tgMessage);

                form.reset();
            } catch (e) {
                console.error("Ошибка при отправке заказа: ", e);
                showNotification("Произошла ошибка. Попробуйте написать нам в WhatsApp.");
            } finally {
                btn.innerText = originalText;
                btn.disabled = false;
            }
        };

        // Экспорт функций слайдера для доступа из loadContent
        window.initializeCardSliders = initializeCardSliders;
        window.runAnimations = runAnimations;

    </script>

    <style>
        /* Стили из оригинала */
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #FBF9F6; color: #4A4A4A; }
        h1, h2, h3, h4, h5, h6, .font-handwritten { font-family: 'Caveat', cursive; }
        .sage-green { color: #8A9A5B; }
        .bg-sage-green { background-color: #8A9A5B; }
        .border-sage-green { border-color: #8A9A5B; }
        .lavender { color: #E6E6FA; }
        .bg-lavender-light { background-color: #F5F5FD; }
        .nav-link.active { color: #8A9A5B; font-weight: bold; border-bottom: 2px solid #8A9A5B; }
        .page-section { display: none; animation: fadeIn 0.8s; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        [data-animate] { opacity: 0; transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .is-visible { opacity: 1; transform: none !important; }
        [data-animate="fade-up"] { transform: translateY(40px); }
        [data-animate="zoom-in"] { transform: scale(0.9); }
        #notification-modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #1a1a1a; z-index: 9999; display: flex; justify-content: center; align-items: center; transition: opacity 0.8s ease, visibility 0.8s ease; }
        #preloader.hidden { opacity: 0; visibility: hidden; }
        #preloader-logo { width: 200px; height: auto; }
        #preloader-logo .sage-path { stroke-dasharray: 1500; stroke-dashoffset: 1500; animation: draw 3.5s ease-in-out forwards; }
        @keyframes draw { to { stroke-dashoffset: 0; } }
        #mobile-menu-button { width: 30px; height: 24px; display: flex; flex-direction: column; justify-content: space-between; cursor: pointer; position: relative; background: transparent; border: none; }
        .burger-line { width: 100%; height: 3px; background-color: #4A4A4A; border-radius: 3px; transition: all 0.3s ease-in-out; }
        #mobile-menu-button.open .burger-line-1 { transform: rotate(45deg) translate(7px, 7px); }
        #mobile-menu-button.open .burger-line-2 { opacity: 0; }
        #mobile-menu-button.open .burger-line-3 { transform: rotate(-45deg) translate(7px, -7px); }
        .dots-container .dot { transition: background-color 0.3s ease; }
        .dots-container .dot.active { background-color: #8A9A5B; }
        .card-slider-container .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; transition: opacity 0.4s ease-in-out; visibility: hidden; }
        .card-slider-container .slide.active { opacity: 1; visibility: visible; }
    </style>
</head>
<body class="antialiased">

    <!-- Preloader -->
    <div id="preloader">
        <svg id="preloader-logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <path class="sage-path" d="M100 180 V 50 M100 130 C75 125 75 155 100 150 M100 130 C125 125 125 155 100 150 M100 100 C80 95 80 120 100 115 M100 100 C120 95 120 120 100 115 M100 75 C90 70 90 90 100 85 M100 75 C110 70 110 90 100 85 M80 160 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0 M120,165 a4,4 0 1,0 -8,0 a4,4 0 1,0 8,0 M75 90 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </div>

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#" class="flex items-center gap-3" onclick="showPage('home')">
                <div class="h-12 w-12 rounded-full bg-white flex items-center justify-center shadow-md overflow-hidden">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/2499.jpg" alt="Логотип Шалфей" class="h-full w-full object-cover">
                </div>
                <span class="text-3xl font-handwritten text-sage-green font-bold">Шалфей</span>
            </a>
            
            <nav class="hidden md:flex space-x-8 items-center">
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('home')">Главная</a>
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('rentals')">Аренда костюмов</a>
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('workshops')">Мастер-классы</a>
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('handmade')">Изделия</a>
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('about')">О нас</a>
                <a href="#" class="nav-link text-gray-600 hover:text-sage-green transition duration-300" onclick="showPage('contacts')">Контакты</a>
            </nav>

            <div class="md:hidden">
                <button id="mobile-menu-button" class="focus:outline-none">
                    <span class="burger-line burger-line-1"></span>
                    <span class="burger-line burger-line-2"></span>
                    <span class="burger-line burger-line-3"></span>
                </button>
            </div>
        </div>

        <div id="mobile-menu" class="hidden md:hidden bg-white/95 backdrop-blur-md">
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('home')">Главная</a>
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('rentals')">Аренда костюмов</a>
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('workshops')">Мастер-классы</a>
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('handmade')">Изделия</a>
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('about')">О нас</a>
            <a href="#" class="block py-3 px-6 text-gray-700 hover:bg-sage-green/10" onclick="showPage('contacts')">Контакты</a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-8 md:py-12 overflow-x-hidden">

        <!-- Home -->
        <section id="home" class="page-section">
            <div class="text-center mb-16">
                <h1 data-animate="fade-up" class="text-5xl md:text-7xl font-bold text-sage-green mb-4">Место, где природа, волшебство и творчество встречаются</h1>
                <p data-animate="fade-up" data-delay="100" class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">«Шалфей» — это не просто мастерская. Это пространство для души, где мы создаем уникальные костюмы, проводим душевные мастер-классы, выращиваем растения и творим красоту своими руками.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div data-animate="zoom-in" class="group relative overflow-hidden rounded-lg shadow-lg cursor-pointer" onclick="showPage('rentals')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/kostum%20krasny%20plasch%20eshe%20photo.jpg" alt="Аренда" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
                        <h3 class="text-white text-3xl font-handwritten font-bold">Аренда костюмов</h3>
                    </div>
                </div>
                <div data-animate="zoom-in" data-delay="100" class="group relative overflow-hidden rounded-lg shadow-lg cursor-pointer" onclick="showPage('workshops')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/Shkatulka%20samodel%20kak%20iz%20medi%20s%20masterclassa.jpg" alt="МК" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
                        <h3 class="text-white text-3xl font-handwritten font-bold">Мастер-классы</h3>
                    </div>
                </div>
                <div data-animate="zoom-in" data-delay="300" class="group relative overflow-hidden rounded-lg shadow-lg cursor-pointer" onclick="showPage('handmade')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kluchnitsa%20dlya%20kluchey%20vvide%20domikov.jpg" alt="Изделия" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
                        <h3 class="text-white text-3xl font-handwritten font-bold">Изделия ручной работы</h3>
                    </div>
                </div>
            </div>
            
            <div class="mt-20 bg-lavender-light p-8 md:p-12 rounded-lg" data-animate="fade-up">
                 <h2 class="text-4xl md:text-5xl text-center font-handwritten text-sage-green mb-8">Атмосфера и отзывы</h2>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <p class="text-gray-600 italic">"Это было волшебно! Костюм превзошел все ожидания, а фотосессия получилась сказочной. Спасибо!"</p>
                        <p class="mt-4 font-bold text-gray-800">- Анастасия</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-sm">
                        <p class="text-gray-600 italic">"Мастер-класс по созданию шкатулки — лучший способ провести выходной. Уютно, творчески и очень душевно."</p>
                        <p class="mt-4 font-bold text-gray-800">- Елена</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-sm">
                        <p class="text-gray-600 italic">"Заказывала ключницу в подарок. Идеальное исполнение и столько тепла в одной маленькой вещице. Благодарю!"</p>
                        <p class="mt-4 font-bold text-gray-800">- Мария</p>
                    </div>
                 </div>
            </div>
        </section>

        <!-- Rentals -->
        <section id="rentals" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl font-handwritten text-sage-green">Аренда костюмов</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-gray-600 mt-2">Выберите образ для вашей фотосессии, праздника или фестиваля.</p>
            </div>
            
            <!-- ДИНАМИЧЕСКИЙ КОНТЕЙНЕР ДЛЯ КОСТЮМОВ -->
            <div id="rentals-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Сюда подгружаются карточки из Firebase -->
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mt-16 bg-lavender-light p-8 md:p-12 rounded-lg" data-animate="fade-up">
                <div>
                    <h3 class="text-3xl font-handwritten text-sage-green mb-4">Условия аренды</h3>
                    <ul class="space-y-3 text-gray-700">
                        <li><i class="fas fa-check-circle text-sage-green mr-2"></i><strong>Залог:</strong> 3000 руб.</li>
                        <li><i class="fas fa-check-circle text-sage-green mr-2"></i><strong>Примерка:</strong> Бесплатная, по записи.</li>
                        <li><i class="fas fa-check-circle text-sage-green mr-2"></i><strong>Возврат:</strong> В чистом виде.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-3xl font-handwritten text-sage-green mb-4">Заявка на аренду</h3>
                    <form id="rental-form" class="space-y-4" onsubmit="submitOrder(event, 'rental-form', 'rentals')">
                        <input name="name" type="text" placeholder="Ваше имя" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <input name="phone" type="tel" placeholder="Ваш телефон" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <input name="costume" type="text" placeholder="Название костюма" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <input name="dates" type="text" placeholder="Желаемые даты аренды" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <button type="submit" class="w-full bg-sage-green text-white font-bold py-3 px-6 rounded-lg hover:bg-opacity-90 transition-colors">Отправить заявку</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Workshops -->
        <section id="workshops" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl font-handwritten text-sage-green">Творческие мастер-классы</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-gray-600 mt-2">Погрузитесь в атмосферу творчества.</p>
            </div>
            
            <!-- ДИНАМИЧЕСКИЙ КОНТЕЙНЕР ДЛЯ МК -->
            <div id="workshops-container" class="space-y-12">
                <!-- Карточки МК -->
            </div>

            <div data-animate="fade-up" class="mt-16 text-center bg-lavender-light p-8 md:p-12 rounded-lg">
                <h3 class="text-4xl font-handwritten text-sage-green">Мастер-класс на вашем празднике</h3>
                <p class="text-gray-700 my-4 max-w-2xl mx-auto">Организуем выездной мастер-класс на девичник, день рождения или корпоратив.</p>
                <button class="bg-white border-2 border-sage-green text-sage-green font-bold py-3 px-8 rounded-lg hover:bg-sage-green hover:text-white transition-colors" onclick="window.prepareOrder('Выездной МК', 'Спецзаказ')">Обсудить детали</button>
            </div>
        </section>

        <!-- Handmade -->
        <section id="handmade" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl font-handwritten text-sage-green">Изделия ручной работы</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-gray-600 mt-2">Уютные детали для вашего дома.</p>
            </div>
            
            <!-- ДИНАМИЧЕСКИЙ КОНТЕЙНЕР ДЛЯ ИЗДЕЛИЙ -->
            <div id="handmade-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Карточки товаров -->
            </div>

             <div data-animate="fade-up" class="mt-12 bg-lavender-light p-8 rounded-lg text-center">
                <h3 class="text-3xl font-handwritten text-sage-green">Как заказать?</h3>
                <p class="text-gray-700 mt-2">Все изделия уникальны. Свяжитесь с нами для заказа.</p>
                <button class="mt-4 bg-sage-green text-white font-bold py-3 px-8 rounded-lg hover:bg-opacity-90 transition-colors" onclick="showPage('contacts')">Связаться с нами</button>
            </div>
        </section>
        
        <!-- About (Static) -->
        <section id="about" class="page-section">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div data-animate="fade-up" class="space-y-6">
                    <h2 class="text-5xl md:text-6xl font-handwritten text-sage-green">Наша история</h2>
                    <p class="text-gray-700 leading-relaxed">Путь к "Шалфею" начался с двух, казалось бы, разных увлечений: дизайна и психологии. Я всегда любила создавать красоту — шить, рисовать, работать с деревом. Параллельно я изучала психологию, погружаясь в темы женских кругов, арт-терапии и силы природы.</p>
                    <p class="text-gray-700 leading-relaxed">В какой-то момент эти два пути сошлись. Я поняла, что творчество — это не просто создание вещей, это способ самовыражения, медитация и исцеление.</p>
                    <h3 class="text-3xl font-handwritten text-sage-green pt-4">Почему "Шалфей"?</h3>
                    <p class="text-gray-700 leading-relaxed">Шалфей символизирует мудрость, здоровье и благополучие. Для нас это символ очищения пространства для нового, для творчества, для себя.</p>
                </div>
                <div data-animate="zoom-in" class="grid grid-cols-2 gap-4">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kostum%20krasny%20plasch%20eshe%20photo.jpg" alt="Photo 1" class="rounded-lg shadow-lg object-cover w-full h-full aspect-[4/5]">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/korzinka%20novogodnaya%20s%20elovimi%20vetochkamy%20i%20hlopok.jpg" alt="Photo 2" class="rounded-lg shadow-lg object-cover w-full h-full mt-8 aspect-[4/5]">
                </div>
            </div>
        </section>
        
        <!-- Contacts -->
        <section id="contacts" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl font-handwritten text-sage-green">Свяжитесь с нами</h2>
            </div>
            <div data-animate="fade-up" class="grid grid-cols-1 md:grid-cols-2 gap-12 bg-white p-8 md:p-12 rounded-lg shadow-md">
                <div class="space-y-6">
                    <div>
                        <h4 class="text-2xl font-handwritten text-gray-800 mb-2">Наши контакты</h4>
                        <p class="text-gray-700"><i class="fas fa-phone-alt text-sage-green mr-3"></i>+7 (920) 322-62-63</p>
                        <p class="text-gray-700"><i class="fab fa-whatsapp text-sage-green mr-3"></i><a href="https://wa.me/79203226263" target="_blank" class="hover:underline">Написать в WhatsApp</a></p>
                        <p class="text-gray-700"><i class="fab fa-telegram-plane text-sage-green mr-3"></i><a href="https://t.me/Taniko_67" target="_blank" class="hover:underline">Написать в Telegram</a></p>
                    </div>
                     <div>
                        <h4 class="text-2xl font-handwritten text-gray-800 mb-2">Мы в соцсетях</h4>
                        <div class="flex space-x-4 text-2xl">
                           <a href="https://vk.com/shalfeyart" target="_blank" class="text-gray-500 hover:text-sage-green"><i class="fab fa-vk"></i></a>
                           <a href="https://t.me/shalfeyart" target="_blank" class="text-gray-500 hover:text-sage-green"><i class="fab fa-telegram-plane"></i> (канал)</a>
                        </div>
                    </div>
                </div>
                <div>
                     <h4 class="text-2xl font-handwritten text-gray-800 mb-2">Напишите нам</h4>
                     <form id="contact-form" class="space-y-4" onsubmit="submitOrder(event, 'contact-form', 'contact')">
                        <input name="name" type="text" placeholder="Ваше имя" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <input name="email" type="text" placeholder="Ваш Email или телефон" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none">
                        <textarea name="message" rows="5" placeholder="Ваше сообщение" required class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-sage-green focus:outline-none"></textarea>
                        <button type="submit" class="w-full bg-sage-green text-white font-bold py-3 px-6 rounded-lg hover:bg-opacity-90 transition-colors">Отправить</button>
                    </form>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto px-6 py-8 text-center">
            <p class="font-handwritten text-2xl mb-2">Шалфей — творческая мастерская</p>
            <p class="text-gray-500 text-sm">&copy; 2024 Шалфей.</p>
        </div>
    </footer>
    
    <!-- Notification Modal -->
    <div id="notification-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 opacity-0 invisible" onclick="this.classList.add('opacity-0', 'invisible')">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm text-center" onclick="event.stopPropagation()">
            <div class="mb-4 text-sage-green text-5xl"><i class="fas fa-check-circle"></i></div>
            <p id="notification-message" class="text-gray-700 text-lg mb-4"></p>
            <button class="bg-sage-green text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-90" onclick="document.getElementById('notification-modal').classList.add('opacity-0', 'invisible')">Отлично</button>
        </div>
    </div>

    <!-- Scripts (Navigation and Animation) -->
    <script>
        // Navigation Logic
        const pages = document.querySelectorAll('.page-section');
        const navLinks = document.querySelectorAll('.nav-link');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuButton = document.getElementById('mobile-menu-button');

        function showPage(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            const activePage = document.getElementById(pageId);
            if (activePage) activePage.classList.add('active');

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('onclick').includes(`'${pageId}'`)) {
                    link.classList.add('active');
                }
            });
            
            mobileMenu.classList.add('hidden');
            mobileMenuButton.classList.remove('open');
            window.scrollTo(0, 0);
            runAnimations(activePage);
        }

        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            mobileMenuButton.classList.toggle('open');
        });

        function showNotification(message) {
            document.getElementById('notification-message').textContent = message;
            const modal = document.getElementById('notification-modal');
            modal.classList.remove('opacity-0', 'invisible');
        }

        // Animation Logic
        function runAnimations(container) {
            const observer = new IntersectionObserver((entries, observerInstance) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const el = entry.target;
                        setTimeout(() => {
                            el.classList.add('is-visible');
                        }, el.dataset.delay || 0);
                        observerInstance.unobserve(el);
                    }
                });
            }, { threshold: 0.1 });

            const animatedElements = container.querySelectorAll('[data-animate]');
            animatedElements.forEach(el => {
                el.classList.remove('is-visible');
                observer.observe(el);
            });
        }
        
        // Slider Logic (Fixed to handle dynamic content)
        function initializeCardSliders() {
            const sliderContainers = document.querySelectorAll('.card-slider-container');

            sliderContainers.forEach(container => {
                // Check if already initialized to avoid duplicate listeners
                if(container.dataset.initialized) return;
                
                const slides = container.querySelectorAll('.slide');
                const prevBtn = container.querySelector('.slider-prev');
                const nextBtn = container.querySelector('.slider-next');
                const dotsContainer = container.parentElement.parentElement.querySelector('.dots-container'); // Adjusted for deeper nesting if needed or find loosely

                // If only 1 slide, hide buttons
                if (slides.length <= 1) {
                    if(prevBtn) prevBtn.style.display = 'none';
                    if(nextBtn) nextBtn.style.display = 'none';
                    return;
                }

                container.dataset.initialized = "true";
                let currentSlide = 0;
                let dots = null;

                // Try to find dots in the parent card
                const card = container.closest('.bg-white');
                if(card) {
                    dots = card.querySelectorAll('.dot');
                }

                function showSlide(n) {
                    if (n >= slides.length) currentSlide = 0;
                    else if (n < 0) currentSlide = slides.length - 1;
                    else currentSlide = n;

                    slides.forEach(slide => slide.classList.remove('active'));
                    if(dots) dots.forEach(dot => dot.classList.remove('active'));

                    if (slides[currentSlide]) slides[currentSlide].classList.add('active');
                    if (dots && dots[currentSlide]) dots[currentSlide].classList.add('active');
                }

                if(prevBtn) prevBtn.addEventListener('click', (e) => { e.stopPropagation(); showSlide(currentSlide - 1); });
                if(nextBtn) nextBtn.addEventListener('click', (e) => { e.stopPropagation(); showSlide(currentSlide + 1); });

                if(dots) {
                    dots.forEach((dot, index) => {
                        dot.addEventListener('click', (e) => { e.stopPropagation(); showSlide(index); });
                    });
                }
            });
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            const preloader = document.getElementById('preloader');
            setTimeout(() => { preloader.classList.add('hidden'); }, 3000);
            showPage('home');
        });
    </script>
</body>
</html>
