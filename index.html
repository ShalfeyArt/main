<!DOCTYPE html>
<html lang="ru" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Шалфей — Творческая мастерская</title>
    <link rel="icon" href="https://raw.githubusercontent.com/ShalfeyArt/main/refs/heads/main/shalfey.ico" type="image/x-icon">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* =========================================
           COLORS & VARIABLES
           ========================================= */
        :root {
            /* Light Theme */
            --md-sys-color-primary: #4C662B;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #CDEDA3;
            --md-sys-color-on-primary-container: #102000;
            --md-sys-color-secondary-container: #DCE7C8;
            --md-sys-color-on-secondary-container: #151E0B;
            --md-sys-color-tertiary: #386663;
            --md-sys-color-tertiary-container: #BCECE7;
            --md-sys-color-on-tertiary-container: #00201E;
            --md-sys-color-surface: #FDFDF5;
            --md-sys-color-on-surface: #1B1C18;
            --md-sys-color-surface-container: #F1F2E8;
            --md-sys-color-surface-container-high: #ECECE2;
            --md-sys-color-surface-container-low: #F7F8EE;
            --md-sys-color-on-surface-variant: #44483D;
            --md-sys-color-outline: #75796C;
            --md-sys-color-outline-variant: #C5C8BA;
            
            /* MD3 Elevation Shadows */
            --md-elevation-1: 0px 1px 3px 0px rgba(0, 0, 0, 0.12), 0px 1px 2px 0px rgba(0, 0, 0, 0.24);
            --md-elevation-2: 0px 4px 6px -1px rgba(0, 0, 0, 0.1), 0px 2px 4px -1px rgba(0, 0, 0, 0.06);
            --md-elevation-3: 0px 10px 15px -3px rgba(0, 0, 0, 0.1), 0px 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        html.dark {
            /* Dark Theme */
            --md-sys-color-primary: #B1D188;
            --md-sys-color-on-primary: #1F3701;
            --md-sys-color-primary-container: #354E16;
            --md-sys-color-on-primary-container: #CDEDA3; /* Это яркий салатовый цвет для текста на контейнере */
            --md-sys-color-secondary-container: #404A33;
            --md-sys-color-on-secondary-container: #DCE7C8;
            --md-sys-color-tertiary: #A0D0CB;
            --md-sys-color-tertiary-container: #1F4E4B;
            --md-sys-color-on-tertiary-container: #BCECE7;
            --md-sys-color-surface: #13140F;
            --md-sys-color-on-surface: #E4E3DB;
            --md-sys-color-surface-container: #1F201C;
            --md-sys-color-surface-container-high: #2A2B25;
            --md-sys-color-surface-container-low: #1B1C18;
            --md-sys-color-on-surface-variant: #C5C8BA;
            --md-sys-color-outline: #8F9285;
            --md-sys-color-outline-variant: #44483D;

            /* Dark mode shadows */
            --md-elevation-1: 0px 1px 2px 0px rgba(0,0,0,0.5); 
            --md-elevation-2: 0px 4px 8px 3px rgba(0,0,0,0.4);
        }

        /* Base Settings */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            transition: background-color 0.4s cubic-bezier(0.2, 0.0, 0, 1.0), color 0.4s;
            margin: 0;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6, .brand-font {
            font-family: 'Caveat', cursive;
        }

        /* === COMPONENT STYLES === */

        /* Theme Toggle Animation */
        .theme-icon {
            position: absolute;
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            top: 50%;
            left: 50%;
            transform-origin: center;
            margin-top: -12px; /* Half of icon size (24px) */
            margin-left: -12px;
        }

        html.light .icon-sun { opacity: 0; transform: rotate(-90deg) scale(0.5); }
        html.light .icon-moon { opacity: 1; transform: rotate(0) scale(1); }

        html.dark .icon-sun { opacity: 1; transform: rotate(0) scale(1); }
        html.dark .icon-moon { opacity: 0; transform: rotate(90deg) scale(0.5); }


        /* Buttons */
        .md-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            padding: 0 24px;
            height: 40px;
            font-weight: 500;
            font-size: 14px;
            letter-spacing: 0.1px;
            transition: all 0.2s cubic-bezier(0.2, 0.0, 0, 1.0);
            cursor: pointer;
        }
        .md-btn:active { transform: scale(0.98); }

        .md-btn-filled {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            box-shadow: var(--md-elevation-1);
        }
        .md-btn-filled:hover {
            box-shadow: var(--md-elevation-2);
            filter: brightness(1.08);
        }

        .md-btn-tonal {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
        }
        .md-btn-tonal:hover {
            filter: brightness(0.95);
            box-shadow: var(--md-elevation-1);
        }
        html.dark .md-btn-tonal:hover { filter: brightness(1.1); }

        .md-btn-text {
            background-color: transparent;
            color: var(--md-sys-color-on-surface-variant);
            padding: 0 16px;
        }
        .md-btn-text:hover {
            background-color: rgba(var(--md-sys-color-on-surface), 0.08);
            color: var(--md-sys-color-on-surface);
        }
        .md-btn-text.active {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
            font-weight: 700;
        }

        /* Cards - MD3 Style */
        .md-card {
            background-color: var(--md-sys-color-surface-container-low);
            border-radius: 24px;
            overflow: hidden;
            transition: transform 0.3s cubic-bezier(0.2, 0.0, 0, 1.0), box-shadow 0.3s cubic-bezier(0.2, 0.0, 0, 1.0);
            border: none;
            box-shadow: var(--md-elevation-1);
        }
        
        html.dark .md-card-elevated {
             background-color: var(--md-sys-color-surface-container);
             border: none;
             box-shadow: 0px 1px 2px rgba(0,0,0,0.3);
        }

        .md-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--md-elevation-2);
        }
        html.dark .md-card:hover { 
            box-shadow: 0px 4px 8px rgba(0,0,0,0.5); 
        }

        /* Inputs */
        .md-input-group { position: relative; margin-bottom: 1rem; }
        .md-input {
            width: 100%;
            background: transparent;
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 8px;
            padding: 16px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.2s;
        }
        .md-input:focus {
            border-color: var(--md-sys-color-primary);
            border-width: 2px;
            padding: 15px;
        }
        .md-label {
            position: absolute;
            left: 16px;
            top: 16px;
            color: var(--md-sys-color-on-surface-variant);
            font-size: 16px;
            pointer-events: none;
            background-color: var(--md-sys-color-surface-container-low);
            padding: 0 4px;
            transition: all 0.2s ease-out;
        }
        .md-input:focus ~ .md-label, .md-input:not(:placeholder-shown) ~ .md-label {
            top: -10px; font-size: 12px; color: var(--md-sys-color-primary); font-weight: 500;
        }
        section.bg-surface-variant .md-label { background-color: var(--md-sys-color-surface-container); }

        /* Navigation */
        .md-top-bar {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        .md-top-bar.scrolled {
            background-color: var(--md-sys-color-surface-container-high);
            box-shadow: var(--md-elevation-2);
        }

        .md-icon-btn {
            width: 48px; height: 48px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--md-sys-color-on-surface-variant);
            transition: background 0.2s;
            border: none;
            background: transparent;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .md-icon-btn:hover { background-color: rgba(var(--md-sys-color-on-surface), 0.08); }

        /* Page Transitions */
        .page-section { display: none; animation: fadeScale 0.4s cubic-bezier(0.2, 0.0, 0, 1.0); }
        .page-section.active { display: block; }
        @keyframes fadeScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        [data-animate] { opacity: 0; transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .is-visible { opacity: 1; transform: none !important; }
        [data-animate="fade-up"] { transform: translateY(30px); }
        [data-animate="zoom-in"] { transform: scale(0.92); }

        /* Slider Controls */
        .slider-nav-btn {
            background-color: rgba(0, 0, 0, 0.3);
            color: white;
            backdrop-filter: blur(4px);
            transition: background-color 0.2s;
        }
        .slider-nav-btn:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }

        /* === SLIDER DOTS (FIXED FOR DARK MODE) === */
        .dots-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding-bottom: 16px;
        }

        .dot { 
            width: 8px; 
            height: 8px; 
            border-radius: 50%; 
            background-color: #E2E3DD; 
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            transition: all 0.4s cubic-bezier(0.2, 0.0, 0, 1.0); 
            opacity: 1;
            border: none;
        }
        
        html.dark .dot {
            background-color: #444746;
            box-shadow: 0 0 0 1px rgba(255,255,255,0.1);
        }

        .dot.active { 
            width: 32px; 
            height: 10px;
            border-radius: 100px; 
            /* LIGHT MODE: Standard primary container */
            background-color: var(--md-sys-color-primary-container); 
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
        }

        /* DARK MODE OVERRIDE FOR ACTIVE DOT */
        html.dark .dot.active {
            /* В темной теме Primary Container (#354E16) слишком темный.
               Мы берем Primary (#B1D188) или OnPrimaryContainer (#CDEDA3)
               чтобы капсула "светилась" как на скриншоте.
            */
            background-color: var(--md-sys-color-primary); 
            /* Добавляем легкое свечение для выразительности */
            box-shadow: 0 0 8px rgba(177, 209, 136, 0.3); 
        }

        /* Preloader */
        #preloader { background-color: var(--md-sys-color-surface); }
        .sage-path { stroke-dasharray: 1500; stroke-dashoffset: 1500; animation: draw 3s forwards; stroke: var(--md-sys-color-primary); }
        @keyframes draw { to { stroke-dashoffset: 0; } }

        /* Utilities */
        .text-primary { color: var(--md-sys-color-primary); }
        .text-on-surface-variant { color: var(--md-sys-color-on-surface-variant); }
        .text-on-surface { color: var(--md-sys-color-on-surface); }
        .bg-surface-variant { background-color: var(--md-sys-color-surface-container); }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col selection:bg-[var(--md-sys-color-primary-container)] selection:text-[var(--md-sys-color-on-primary-container)]">

    <!-- =========== PRELOADER =========== -->
    <!-- Removed duration-700 to control it manually with js logic -->
    <div id="preloader" class="fixed inset-0 z-[100] flex justify-center items-center transition-opacity duration-500 ease-out">
        <div class="flex flex-col items-center">
            <svg id="preloader-logo" class="w-32 h-32 mb-4" viewBox="0 0 200 200">
                <path class="sage-path" d="M100 180 V 50 M100 130 C75 125 75 155 100 150 M100 130 C125 125 125 155 100 150 M100 100 C80 95 80 120 100 115 M100 100 C120 95 120 120 100 115 M100 75 C90 70 90 90 100 85 M100 75 C110 70 110 90 100 85 M80 160 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0 M120,165 a4,4 0 1,0 -8,0 a4,4 0 1,0 8,0 M75 90 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div class="text-primary font-medium tracking-wider text-sm opacity-0 transition-opacity duration-300" id="loading-text">Загрузка вдохновения...</div>
        </div>
    </div>

    <!-- =========== APP BAR =========== -->
    <header id="top-bar" class="md-top-bar sticky top-0 z-50 w-full transition-all duration-300">
        <div class="container mx-auto px-4 h-16 flex justify-between items-center">
            
            <!-- Logo & Mobile Menu Trigger -->
            <div class="flex items-center gap-2">
                <button id="mobile-menu-btn" class="md-icon-btn md:hidden">
                    <span class="material-symbols-rounded">menu</span>
                </button>
                <a href="#home" class="flex items-center gap-3 group prevent-default" onclick="navigateTo('home', event)">
                    <div class="h-10 w-10 rounded-full overflow-hidden shadow-sm border border-[var(--md-sys-color-outline-variant)]">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/2499.jpg" alt="Логотип" class="h-full w-full object-cover">
                    </div>
                    <span class="text-2xl brand-font font-bold text-primary group-hover:opacity-80 transition-opacity">Шалфей</span>
                </a>
            </div>
            
            <!-- Desktop Nav -->
            <nav class="hidden md:flex items-center space-x-1">
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('home')">Главная</button>
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('rentals')">Аренда</button>
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('workshops')">Мастер-классы</button>
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('handmade')">Изделия</button>
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('about')">О нас</button>
                <button class="md-btn md-btn-text nav-link" onclick="navigateTo('contacts')">Контакты</button>
            </nav>

            <!-- Actions (Theme Toggle) -->
            <div class="flex items-center">
                <button id="theme-toggle" class="md-icon-btn" aria-label="Переключить тему">
                    <span class="material-symbols-rounded theme-icon icon-sun">light_mode</span>
                    <span class="material-symbols-rounded theme-icon icon-moon">dark_mode</span>
                </button>
            </div>
        </div>
    </header>

    <!-- =========== MOBILE DRAWER =========== -->
    <div id="mobile-drawer-overlay" class="fixed inset-0 bg-black/50 z-[60] hidden opacity-0 transition-opacity duration-300 backdrop-blur-sm"></div>
    <aside id="mobile-menu" class="fixed top-0 left-0 bottom-0 w-[300px] z-[70] transform -translate-x-full transition-transform duration-300 flex flex-col py-6 px-4 bg-[var(--md-sys-color-surface-container)]">
        <div class="flex items-center justify-between mb-8 px-2">
            <span class="text-3xl brand-font font-bold text-primary">Меню</span>
            <button id="close-menu-btn" class="md-icon-btn">
                <span class="material-symbols-rounded">close</span>
            </button>
        </div>
        <nav class="flex flex-col gap-2">
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('home')"><span class="material-symbols-rounded mr-4">home</span>Главная</button>
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('rentals')"><span class="material-symbols-rounded mr-4">checkroom</span>Аренда</button>
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('workshops')"><span class="material-symbols-rounded mr-4">brush</span>Мастер-классы</button>
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('handmade')"><span class="material-symbols-rounded mr-4">local_mall</span>Изделия</button>
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('about')"><span class="material-symbols-rounded mr-4">psychology</span>О нас</button>
            <button class="md-btn md-btn-text w-full justify-start text-lg h-12 rounded-full" onclick="navigateTo('contacts')"><span class="material-symbols-rounded mr-4">mail</span>Контакты</button>
        </nav>
    </aside>

    <!-- =========== MAIN CONTENT =========== -->
    <main class="container mx-auto px-4 py-6 md:py-10 flex-grow">

        <!-- ===== HOME ===== -->
        <section id="home" class="page-section">
            <div class="flex flex-col items-center text-center mb-16 px-4">
                <div data-animate="fade-up" class="inline-flex items-center justify-center p-3 mb-6 rounded-full bg-[var(--md-sys-color-secondary-container)] text-[var(--md-sys-color-on-secondary-container)]">
                    <span class="material-symbols-rounded text-xl mr-2">spa</span>
                    <span class="text-sm font-medium">Творчество & Природа</span>
                </div>
                <h1 data-animate="fade-up" data-delay="100" class="text-5xl md:text-7xl font-bold text-primary mb-6 leading-tight">Природа, волшебство<br>и вдохновение</h1>
                <p data-animate="fade-up" data-delay="200" class="text-lg md:text-xl text-on-surface-variant max-w-2xl mx-auto leading-relaxed">
                    Пространство для души, где мы создаем уникальные костюмы, проводим душевные мастер-классы и творим красоту.
                </p>
                <div data-animate="fade-up" data-delay="300" class="mt-8 flex gap-4">
                    <button class="md-btn md-btn-filled" onclick="navigateTo('rentals')">Смотреть костюмы</button>
                    <button class="md-btn md-btn-tonal" onclick="navigateTo('workshops')">Записаться на МК</button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                <div data-animate="zoom-in" class="group relative h-80 md:h-96 rounded-[32px] overflow-hidden cursor-pointer shadow-md hover:shadow-xl transition-shadow duration-300" onclick="navigateTo('rentals')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/kostum%20krasny%20plasch%20eshe%20photo.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" alt="Аренда">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent flex flex-col justify-end p-8">
                        <h3 class="text-white text-4xl brand-font">Аренда костюмов</h3>
                    </div>
                </div>
                <div data-animate="zoom-in" data-delay="100" class="group relative h-80 md:h-96 rounded-[32px] overflow-hidden cursor-pointer shadow-md hover:shadow-xl transition-shadow duration-300" onclick="navigateTo('workshops')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/Shkatulka%20samodel%20kak%20iz%20medi%20s%20masterclassa.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" alt="МК">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent flex flex-col justify-end p-8">
                        <h3 class="text-white text-4xl brand-font">Мастер-классы</h3>
                    </div>
                </div>
                <div data-animate="zoom-in" data-delay="200" class="group relative h-80 md:h-96 rounded-[32px] overflow-hidden cursor-pointer shadow-md hover:shadow-xl transition-shadow duration-300" onclick="navigateTo('handmade')">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kluchnitsa%20dlya%20kluchey%20vvide%20domikov.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" alt="Изделия">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent flex flex-col justify-end p-8">
                        <h3 class="text-white text-4xl brand-font">Изделия</h3>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== RENTALS ===== -->
        <section id="rentals" class="page-section">
            <div class="text-center mb-12 max-w-4xl mx-auto">
                <span class="text-primary font-bold tracking-wider uppercase text-sm">Коллекция</span>
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl brand-font text-on-surface mt-2 mb-4">Волшебные образы</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-on-surface-variant">Выберите образ для вашей фотосессии, праздника или фестиваля.</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Card 1 -->
                <div data-animate="zoom-in" class="md-card md-card-elevated flex flex-col">
                    <div class="relative h-80 w-full bg-gray-200 card-slider-container" data-slider-id="costume-gold">
                        <div class="slide active absolute inset-0 transition-opacity duration-500 opacity-100 z-10"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/blackgold-demonstraciyanakidkiteploy.jpg" class="w-full h-full object-cover"></div>
                        <div class="slide absolute inset-0 transition-opacity duration-500 opacity-0 z-0"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/blackgold-smitritvzerkalodemonstriuyakorony.jpg" class="w-full h-full object-cover"></div>
                        <div class="slide absolute inset-0 transition-opacity duration-500 opacity-0 z-0"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/blackgold-vplonyrost.jpg" class="w-full h-full object-cover"></div>
                        
                        <button class="slider-prev slider-nav-btn absolute left-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_left</span></button>
                        <button class="slider-next slider-nav-btn absolute right-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_right</span></button>
                        
                        <div class="absolute bottom-0 left-0 right-0 z-20 dots-container">
                            <div class="dot active"></div><div class="dot"></div><div class="dot"></div>
                        </div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h4 class="text-2xl brand-font font-bold text-on-surface">Темное золото</h4>
                        <p class="text-on-surface-variant mt-2 text-sm leading-relaxed flex-grow">Элегантный черный костюм с позолоченной отделкой. Загадочный и величественный образ.</p>
                        <div class="mt-6 pt-4 border-t border-[var(--md-sys-color-outline-variant)]">
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-on-surface-variant">Сутки</span>
                                <span class="font-bold text-primary text-lg">800 ₽</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 2 -->
                <div data-animate="zoom-in" data-delay="100" class="md-card md-card-elevated flex flex-col">
                    <div class="relative h-80 w-full bg-gray-200 card-slider-container" data-slider-id="costume-red">
                        <div class="slide active absolute inset-0 transition-opacity duration-500 opacity-100"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kostum%20krasny%20plasch%20eshe%20photo.jpg" class="w-full h-full object-cover"></div>
                        <div class="slide absolute inset-0 transition-opacity duration-500 opacity-0"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/krashy%20plasch%20kostum.jpg" class="w-full h-full object-cover"></div>
                        
                        <button class="slider-prev slider-nav-btn absolute left-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_left</span></button>
                        <button class="slider-next slider-nav-btn absolute right-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_right</span></button>
                        
                        <div class="absolute bottom-0 left-0 right-0 z-20 dots-container">
                            <div class="dot active"></div><div class="dot"></div>
                        </div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h4 class="text-2xl brand-font font-bold text-on-surface">Красная мантия</h4>
                        <p class="text-on-surface-variant mt-2 text-sm leading-relaxed flex-grow">Яркий и запоминающийся образ. Отлично смотрится на фотографиях и подходит для сказок.</p>
                        <div class="mt-6 pt-4 border-t border-[var(--md-sys-color-outline-variant)]">
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-on-surface-variant">Сутки</span>
                                <span class="font-bold text-primary text-lg">800 ₽</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 3 -->
                <div data-animate="zoom-in" data-delay="200" class="md-card md-card-elevated flex flex-col">
                    <div class="relative h-80 w-full bg-gray-200 card-slider-container" data-slider-id="costume-witch">
                        <div class="slide active absolute inset-0 transition-opacity duration-500 opacity-100"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/vedmochka2.jpg" class="w-full h-full object-cover"></div>
                        <div class="slide absolute inset-0 transition-opacity duration-500 opacity-0"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/vedmochka1.jpg" class="w-full h-full object-cover"></div>
                        <div class="slide absolute inset-0 transition-opacity duration-500 opacity-0"><img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/refs/heads/main/esche%20vedmochki.jpg" class="w-full h-full object-cover"></div>
                        
                        <button class="slider-prev slider-nav-btn absolute left-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_left</span></button>
                        <button class="slider-next slider-nav-btn absolute right-2 top-1/2 -translate-y-1/2 z-20 w-10 h-10 rounded-full flex items-center justify-center"><span class="material-symbols-rounded">chevron_right</span></button>
                        
                        <div class="absolute bottom-0 left-0 right-0 z-20 dots-container">
                            <div class="dot active"></div><div class="dot"></div><div class="dot"></div>
                        </div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h4 class="text-2xl brand-font font-bold text-on-surface">Лесная ведунья</h4>
                        <p class="text-on-surface-variant mt-2 text-sm leading-relaxed flex-grow">Таинственный и аутентичный наряд. Многослойная одежда и аксессуары.</p>
                        <div class="mt-6 pt-4 border-t border-[var(--md-sys-color-outline-variant)]">
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium text-on-surface-variant">Сутки</span>
                                <span class="font-bold text-primary text-lg">800 ₽</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form -->
            <div class="mt-16 grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-16 items-start">
                <div class="bg-surface-variant p-8 rounded-[32px]">
                     <h3 class="text-3xl brand-font text-primary mb-6">Условия аренды</h3>
                     <ul class="space-y-4">
                        <li class="flex items-start gap-4">
                            <span class="w-8 h-8 rounded-full bg-[var(--md-sys-color-primary-container)] text-on-primary-container flex items-center justify-center flex-shrink-0"><span class="material-symbols-rounded text-lg">payments</span></span>
                            <div>
                                <strong class="block text-on-surface">Залог 3000 руб.</strong>
                                <span class="text-on-surface-variant text-sm">Возвращается сразу при сдаче костюма.</span>
                            </div>
                        </li>
                         <li class="flex items-start gap-4">
                            <span class="w-8 h-8 rounded-full bg-[var(--md-sys-color-primary-container)] text-on-primary-container flex items-center justify-center flex-shrink-0"><span class="material-symbols-rounded text-lg">checkroom</span></span>
                            <div>
                                <strong class="block text-on-surface">Бесплатная примерка</strong>
                                <span class="text-on-surface-variant text-sm">По предварительной записи.</span>
                            </div>
                        </li>
                     </ul>
                </div>
                <div>
                    <h3 class="text-3xl brand-font text-on-surface mb-6">Забронировать</h3>
                    <form id="rental-form" class="space-y-4">
                        <div class="md-input-group">
                            <input name="name" type="text" id="r-name" placeholder=" " class="md-input peer" required>
                            <label for="r-name" class="md-label">Ваше имя</label>
                        </div>
                        <div class="md-input-group">
                            <input name="phone" type="tel" id="r-phone" placeholder=" " class="md-input peer" required>
                            <label for="r-phone" class="md-label">Ваш телефон</label>
                        </div>
                        <div class="md-input-group">
                            <input name="costume" type="text" id="r-costume" placeholder=" " class="md-input peer" required>
                            <label for="r-costume" class="md-label">Название костюма</label>
                        </div>
                        <div class="md-input-group">
                            <input name="dates" type="text" id="r-dates" placeholder=" " class="md-input peer" required>
                            <label for="r-dates" class="md-label">Желаемые даты</label>
                        </div>
                        <button type="submit" class="md-btn md-btn-filled w-full mt-2">
                            <span class="material-symbols-rounded mr-2">send</span>
                            Отправить в Telegram
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- ===== WORKSHOPS ===== -->
        <section id="workshops" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl brand-font text-primary">Творческие встречи</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-on-surface-variant mt-2">Создавайте прекрасное своими руками.</p>
            </div>
            
            <div class="space-y-8">
                <div data-animate="fade-up" class="md-card md-card-elevated flex flex-col md:flex-row overflow-hidden">
                    <div class="w-full md:w-2/5 h-64 md:h-auto">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/Shkatulka%20samodel%20kak%20iz%20medi%20s%20masterclassa.jpg" class="w-full h-full object-cover">
                    </div>
                    <div class="p-8 flex-1 flex flex-col justify-center">
                        <h3 class="text-3xl brand-font text-on-surface mb-2">Шкатулка "Медное сокровище"</h3>
                        <p class="text-on-surface-variant mb-6 leading-relaxed">Освойте техники декорирования и состаривания, научитесь создавать имитацию чеканки по меди.</p>
                        <div class="flex items-center justify-between mt-auto">
                            <span class="text-2xl font-bold text-primary">1500 ₽</span>
                            <button class="md-btn md-btn-filled" onclick="signUpViaTelegram('Хочу на МК по шкатулке')">Записаться</button>
                        </div>
                    </div>
                </div>

                <div data-animate="fade-up" class="md-card md-card-elevated flex flex-col md:flex-row-reverse overflow-hidden">
                    <div class="w-full md:w-2/5 h-64 md:h-auto">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/korobka%20elochnie%20igrushky.jpg" class="w-full h-full object-cover">
                    </div>
                    <div class="p-8 flex-1 flex flex-col justify-center">
                        <h3 class="text-3xl brand-font text-on-surface mb-2">Роспись новогодних игрушек</h3>
                        <p class="text-on-surface-variant mb-6 leading-relaxed">Собственный набор уникальных украшений! Деревянные заготовки, краски, блёстки и декор включены.</p>
                        <div class="flex items-center justify-between mt-auto">
                            <span class="text-2xl font-bold text-primary">1000 ₽</span>
                            <button class="md-btn md-btn-filled" onclick="signUpViaTelegram('Хочу на МК по игрушкам')">Записаться</button>
                        </div>
                    </div>
                </div>
            </div>

            <div data-animate="fade-up" class="mt-12 p-10 rounded-[32px] bg-[var(--md-sys-color-tertiary-container)] text-[var(--md-sys-color-on-tertiary-container)] text-center">
                <h3 class="text-3xl brand-font mb-4">Выездной мастер-класс</h3>
                <p class="mb-6 opacity-90 max-w-xl mx-auto">Девичник, день рождения или корпоратив? Мы организуем творческое пространство на вашей территории.</p>
                <button class="md-btn bg-[var(--md-sys-color-tertiary)] text-white hover:brightness-110 shadow-md" onclick="signUpViaTelegram('Обсудить выездной МК')">Обсудить детали</button>
            </div>
        </section>

        <!-- ===== HANDMADE ===== -->
        <section id="handmade" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl brand-font text-primary">Ручная работа</h2>
                <p data-animate="fade-up" data-delay="100" class="text-lg text-on-surface-variant mt-2">Уютные детали, созданные с душой.</p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Item 1 -->
                <div data-animate="zoom-in" class="md-card md-card-elevated flex flex-col">
                    <div class="h-64 overflow-hidden">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kluchnitsa%20dlya%20kluchey%20vvide%20domikov.jpg" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <h4 class="text-xl brand-font font-bold text-on-surface">Ключница "Домики"</h4>
                        <p class="text-sm text-on-surface-variant mt-2 flex-grow">Очаровательный декор для прихожей.</p>
                        <span class="mt-4 text-lg font-bold text-primary">1500 ₽</span>
                    </div>
                </div>
                <!-- Item 2 -->
                <div data-animate="zoom-in" data-delay="100" class="md-card md-card-elevated flex flex-col">
                    <div class="h-64 overflow-hidden">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/Shkatulka%20samodel%20kak%20iz%20medi%20s%20masterclassa.jpg" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <h4 class="text-xl brand-font font-bold text-on-surface">Шкатулка "Медь"</h4>
                        <p class="text-sm text-on-surface-variant mt-2 flex-grow">Имитация чеканки, ручная роспись.</p>
                        <span class="mt-4 text-lg font-bold text-primary">от 800 ₽</span>
                    </div>
                </div>
                <!-- Item 3 -->
                <div data-animate="zoom-in" data-delay="200" class="md-card md-card-elevated flex flex-col">
                    <div class="h-64 overflow-hidden">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/elochny%20igrushky%20vnutry.jpg" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <h4 class="text-xl brand-font font-bold text-on-surface">Набор "Зимняя сказка"</h4>
                        <p class="text-sm text-on-surface-variant mt-2 flex-grow">Уникальные украшения на елку.</p>
                        <span class="mt-4 text-lg font-bold text-primary">1000 ₽</span>
                    </div>
                </div>
                <!-- Item 4 -->
                <div data-animate="zoom-in" data-delay="300" class="md-card md-card-elevated flex flex-col">
                    <div class="h-64 overflow-hidden">
                        <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/korzinka%20novogodnaya%20s%20elovimi%20vetochkamy%20i%20hlopok.jpg" class="w-full h-full object-cover hover:scale-110 transition-transform duration-500">
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <h4 class="text-xl brand-font font-bold text-on-surface">Композиция</h4>
                        <p class="text-sm text-on-surface-variant mt-2 flex-grow">Еловые ветки и хлопок в корзинке.</p>
                        <span class="mt-4 text-lg font-bold text-primary">1100 ₽</span>
                    </div>
                </div>
            </div>
            
            <div class="mt-12 flex justify-center">
                 <button class="md-btn md-btn-tonal h-12 px-8" onclick="navigateTo('contacts')">
                    <span class="material-symbols-rounded mr-2">shopping_bag</span>
                    Сделать индивидуальный заказ
                </button>
            </div>
        </section>

        <!-- ===== ABOUT ===== -->
        <section id="about" class="page-section">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div data-animate="fade-up">
                    <h2 class="text-5xl md:text-6xl brand-font text-primary mb-6">Наша история</h2>
                    <div class="space-y-6 text-lg text-on-surface-variant leading-relaxed">
                        <p>Путь к "Шалфею" начался с двух увлечений: дизайна и психологии. Я всегда любила создавать красоту, но также изучала психологию, погружаясь в темы арт-терапии и силы природы.</p>
                        <p class="pl-4 border-l-4 border-[var(--md-sys-color-primary)]">"Шалфей" — это не просто вещи. Это медитация, исцеление и способ самовыражения.</p>
                        <p>Шалфей символизирует мудрость и очищение. Мы создаем пространство для нового, для творчества и для себя.</p>
                    </div>
                </div>
                <div data-animate="zoom-in" class="grid grid-cols-2 gap-4">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/kostum%20krasny%20plasch%20eshe%20photo.jpg" class="rounded-[24px] shadow-md object-cover w-full h-full aspect-[4/5] bg-gray-200">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/korzinka%20novogodnaya%20s%20elovimi%20vetochkamy%20i%20hlopok.jpg" class="rounded-[24px] shadow-md object-cover w-full h-full mt-8 aspect-[4/5] bg-gray-200">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/esche%20vedmochki.jpg" class="rounded-[24px] shadow-md object-cover w-full h-full aspect-[4/5] bg-gray-200">
                    <img src="https://raw.githubusercontent.com/XtraDamage/Tonimage-/main/Shkatulka%20samodel%20kak%20iz%20medi%20s%20masterclassa.jpg" class="rounded-[24px] shadow-md object-cover w-full h-full mt-8 aspect-[4/5] bg-gray-200">
                </div>
            </div>
        </section>

        <!-- ===== CONTACTS ===== -->
        <section id="contacts" class="page-section">
            <div class="text-center mb-12">
                <h2 data-animate="fade-up" class="text-5xl md:text-6xl brand-font text-primary">На связи</h2>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-5xl mx-auto">
                <div data-animate="fade-right" class="bg-surface-variant p-8 md:p-10 rounded-[32px] space-y-8">
                    <div>
                        <h4 class="text-2xl brand-font text-on-surface mb-4">Контакты</h4>
                        <div class="space-y-3">
                            <a href="tel:+79203226263" class="flex items-center gap-4 text-on-surface hover:text-primary transition">
                                <span class="w-10 h-10 rounded-full bg-[var(--md-sys-color-surface)] flex items-center justify-center"><i class="fas fa-phone-alt"></i></span>
                                +7 (920) 322-62-63
                            </a>
                            <a href="https://wa.me/79203226263" target="_blank" class="flex items-center gap-4 text-on-surface hover:text-primary transition">
                                <span class="w-10 h-10 rounded-full bg-[var(--md-sys-color-surface)] flex items-center justify-center"><i class="fab fa-whatsapp"></i></span>
                                WhatsApp
                            </a>
                             <a href="https://t.me/Taniko_67" target="_blank" class="flex items-center gap-4 text-on-surface hover:text-primary transition">
                                <span class="w-10 h-10 rounded-full bg-[var(--md-sys-color-surface)] flex items-center justify-center"><i class="fab fa-telegram-plane"></i></span>
                                Telegram (личные)
                            </a>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-2xl brand-font text-on-surface mb-4">Адрес</h4>
                         <div class="flex items-start gap-4 text-on-surface">
                            <span class="w-10 h-10 rounded-full bg-[var(--md-sys-color-surface)] flex items-center justify-center flex-shrink-0"><i class="fas fa-map-marker-alt"></i></span>
                            <div>
                                <p>Смоленская область, д. Станички</p>
                                <p>ул. Полевая, д. 12</p>
                                <p class="text-sm text-on-surface-variant mt-1">(по предварительной записи)</p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-2xl brand-font text-on-surface mb-4">Соцсети</h4>
                        <div class="flex gap-4">
                            <a href="https://vk.com/shalfeyart" target="_blank" class="md-icon-btn bg-[var(--md-sys-color-surface)]"><i class="fab fa-vk text-xl"></i></a>
                            <a href="https://t.me/shalfeyart" target="_blank" class="md-icon-btn bg-[var(--md-sys-color-surface)]"><i class="fab fa-telegram-plane text-xl"></i></a>
                        </div>
                    </div>
                </div>

                <div data-animate="fade-left">
                    <form id="contact-form" class="bg-[var(--md-sys-color-surface-container-low)] p-8 md:p-10 rounded-[32px] border border-[var(--md-sys-color-outline-variant)] space-y-5 shadow-sm">
                        <h4 class="text-2xl brand-font text-on-surface mb-2">Напишите нам</h4>
                        <div class="md-input-group">
                            <input name="name" type="text" id="c-name" placeholder=" " class="md-input peer" required>
                            <label for="c-name" class="md-label">Ваше имя</label>
                        </div>
                        <div class="md-input-group">
                            <input name="email" type="text" id="c-email" placeholder=" " class="md-input peer" required>
                            <label for="c-email" class="md-label">Email или телефон</label>
                        </div>
                        <div class="md-input-group">
                            <textarea name="message" id="c-message" rows="4" placeholder=" " class="md-input peer" required></textarea>
                            <label for="c-message" class="md-label">Сообщение</label>
                        </div>
                        <button type="submit" class="md-btn md-btn-filled w-full h-12 text-lg">
                            <span class="material-symbols-rounded mr-2">send</span>
                            Отправить
                        </button>
                    </form>
                </div>
            </div>
        </section>

    </main>

    <!-- =========== FOOTER =========== -->
    <footer class="bg-[var(--md-sys-color-surface-container-high)] text-on-surface py-8 mt-12 transition-colors duration-300">
        <div class="container mx-auto px-4 flex flex-col items-center">
            <span class="text-3xl brand-font text-primary mb-4">Шалфей</span>
            <div class="flex space-x-6 mb-6">
                <a href="https://vk.com/shalfeyart" target="_blank" class="text-on-surface-variant hover:text-primary transition transform hover:scale-110"><i class="fab fa-vk text-2xl"></i></a>
                <a href="https://t.me/shalfeyart" target="_blank" class="text-on-surface-variant hover:text-primary transition transform hover:scale-110"><i class="fab fa-telegram-plane text-2xl"></i></a>
                <a href="https://wa.me/79203226263" target="_blank" class="text-on-surface-variant hover:text-primary transition transform hover:scale-110"><i class="fab fa-whatsapp text-2xl"></i></a>
            </div>
            <p class="text-sm text-on-surface-variant">&copy; 2026 Творческая мастерская. Все права защищены.</p>
        </div>
    </footer>

    <!-- =========== NOTIFICATION =========== -->
    <div id="notification-modal" class="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 opacity-0 translate-y-10 pointer-events-none">
        <div class="bg-[var(--md-sys-color-on-surface)] text-[var(--md-sys-color-surface)] px-6 py-3 rounded-lg shadow-lg flex items-center gap-4 min-w-[300px]">
            <span id="notification-message" class="text-sm flex-grow">Сообщение отправлено</span>
            <button onclick="closeNotification()" class="text-[var(--md-sys-color-primary-container)] text-sm font-bold hover:opacity-80">OK</button>
        </div>
    </div>

    <!-- =========== SCRIPTS =========== -->
    <script>
        const TELEGRAM_USERNAME = 'Taniko_67';

        // --- ROUTING CONFIGURATION (HASH BASED) ---
        // ИСПРАВЛЕНИЕ 404: Используем HASH (#) для навигации.
        // Это гарантирует, что при перезагрузке сервер всегда отдаст index.html,
        // а JS уже сам разберется, какую секцию показать.
        
        // Карта: ХЕШ (URL) -> ID СЕКЦИИ
        const ROUTES = {
            '': 'home',               // Если хеша нет
            '#home': 'home',
            '#rentals': 'rentals',
            '#master-classes': 'workshops', // URL будет /#master-classes, а откроет секцию workshops
            '#handmade': 'handmade',
            '#about': 'about',
            '#contacts': 'contacts'
        };

        // Вспомогательная функция: Получить хеш по ID секции (для кнопок)
        function getHashFromId(id) {
            for (const [hash, sectionId] of Object.entries(ROUTES)) {
                if (sectionId === id && hash !== '') return hash;
            }
            return '#home';
        }

        // --- THEME SWITCHER LOGIC ---
        const themeToggleBtn = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            htmlElement.classList.add('dark');
            htmlElement.classList.remove('light');
        } else {
            htmlElement.classList.remove('dark');
            htmlElement.classList.add('light');
        }

        themeToggleBtn.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                htmlElement.classList.remove('dark');
                htmlElement.classList.add('light');
                localStorage.setItem('theme', 'light');
            } else {
                htmlElement.classList.add('dark');
                htmlElement.classList.remove('light');
                localStorage.setItem('theme', 'dark');
            }
        });

        // --- NAVIGATION & ROUTING LOGIC ---
        const pages = document.querySelectorAll('.page-section');
        const navLinks = document.querySelectorAll('.nav-link');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileDrawerOverlay = document.getElementById('mobile-drawer-overlay');
        const topBar = document.getElementById('top-bar');

        // Main Navigation Function (Triggered by clicks)
        function navigateTo(pageId, event) {
            if(event) event.preventDefault();
            
            // Находим нужный хеш для этого ID
            const targetHash = getHashFromId(pageId);
            
            // Просто меняем хеш. Браузер сам вызовет событие 'hashchange'
            window.location.hash = targetHash;
        }

        // Render the View (Triggered by hash change or load)
        function handleLocation() {
            // Берем текущий хеш, или #home если пусто
            const hash = window.location.hash || '#home';
            
            // Находим ID секции в нашей карте, или 'home' если хеш неизвестен
            const pageId = ROUTES[hash] || 'home'; 

            renderPage(pageId);
        }

        function renderPage(pageId) {
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            closeMobileMenu();

            // Switch content
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.add('active');
                    runAnimations(page);
                } else {
                    page.classList.remove('active');
                }
            });

            // Update Active State on Nav
            navLinks.forEach(btn => {
                // Проверяем, ведет ли кнопка на текущую страницу
                const onClickAttr = btn.getAttribute('onclick');
                if(onClickAttr && onClickAttr.includes(`'${pageId}'`)) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        // --- MOBILE MENU ---
        document.getElementById('mobile-menu-btn').addEventListener('click', () => {
            mobileMenu.classList.remove('-translate-x-full');
            mobileDrawerOverlay.classList.remove('hidden');
            setTimeout(() => mobileDrawerOverlay.classList.remove('opacity-0'), 10);
        });

        function closeMobileMenu() {
            mobileMenu.classList.add('-translate-x-full');
            mobileDrawerOverlay.classList.add('opacity-0');
            setTimeout(() => mobileDrawerOverlay.classList.add('hidden'), 300);
        }

        document.getElementById('close-menu-btn').addEventListener('click', closeMobileMenu);
        mobileDrawerOverlay.addEventListener('click', closeMobileMenu);

        // --- SCROLL EFFECT ---
        window.addEventListener('scroll', () => {
            if (window.scrollY > 20) topBar.classList.add('scrolled');
            else topBar.classList.remove('scrolled');
        });

        // --- INITIALIZATION & TRUE PRELOADER ---
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        async function initApp() {
            const preloader = document.getElementById('preloader');
            const loadingText = document.getElementById('loading-text');
            
            // Show loading text after a brief delay if loading takes time
            const textTimeout = setTimeout(() => {
                loadingText.classList.remove('opacity-0');
            }, 500);

            try {
                // 1. Wait for Fonts to load
                await document.fonts.ready;
                console.log('Fonts loaded');

                // 2. Wait for all images
                // The window.onload event fires when all content (images, scripts, CSS) is loaded.
                // However, we are already inside DOMContentLoaded, so we might need to check document.readyState
                // or attach to window.load. To be robust, we use a Promise wrapper for window.load
                
                await new Promise((resolve) => {
                    if (document.readyState === 'complete') {
                        resolve();
                    } else {
                        window.addEventListener('load', resolve);
                        // Fallback safety timeout (5 seconds max)
                        setTimeout(resolve, 5000); 
                    }
                });
                console.log('Images loaded');

            } catch (e) {
                console.warn("Error during loading:", e);
            } finally {
                // Clear text timeout
                clearTimeout(textTimeout);
                
                // Hide preloader with a smooth fade out
                preloader.classList.add('opacity-0', 'pointer-events-none');
                
                // Start the app logic after preloader is done
                setTimeout(() => {
                    // Слушаем изменения хеша в URL
                    window.addEventListener('hashchange', handleLocation);
                    // Запускаем роутинг
                    handleLocation();
                    
                    initializeCardSliders();

                    // Prevent default link clicks for internal navigation
                    document.querySelectorAll('a.prevent-default').forEach(link => {
                        link.addEventListener('click', function(e) {
                           e.preventDefault(); 
                        });
                    });
                }, 500); // Matches the preloader fade out duration
            }
        }

        // --- NOTIFICATIONS ---
        function showNotification(message) {
            const modal = document.getElementById('notification-modal');
            document.getElementById('notification-message').textContent = message;
            modal.classList.remove('translate-y-10', 'opacity-0', 'pointer-events-none');
            setTimeout(() => closeNotification(), 4000);
        }

        function closeNotification() {
            const modal = document.getElementById('notification-modal');
            modal.classList.add('translate-y-10', 'opacity-0', 'pointer-events-none');
        }

        // --- TELEGRAM ---
        function redirectToTelegram(text) {
            const encodedText = encodeURIComponent(text);
            window.open(`https://t.me/${TELEGRAM_USERNAME}?text=${encodedText}`, '_blank');
        }

        function signUpViaTelegram(msg) { redirectToTelegram(msg); }

        // --- FORMS ---
        document.getElementById('rental-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const form = e.target;
            const message = `🛎️ Новая заявка на аренду:\n\n👤 ${form.elements.name.value}\n📞 ${form.elements.phone.value}\n👘 ${form.elements.costume.value}\n🗓 ${form.elements.dates.value}`;
            redirectToTelegram(message);
            form.reset();
            showNotification('Переходим в Telegram...');
        });
        
        document.getElementById('contact-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const form = e.target;
            const message = `📝 Сообщение с сайта:\n\n👤 ${form.elements.name.value}\n📧 ${form.elements.email.value}\n💬 ${form.elements.message.value}`;
            redirectToTelegram(message);
            form.reset();
            showNotification('Переходим в Telegram...');
        });

        // --- ANIMATIONS ---
        const observer = new IntersectionObserver((entries, observerInstance) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const el = entry.target;
                    setTimeout(() => el.classList.add('is-visible'), el.dataset.delay || 0);
                    observerInstance.unobserve(el);
                }
            });
        }, { threshold: 0.1 });

        function runAnimations(container) {
            container.querySelectorAll('[data-animate]').forEach(el => {
                el.classList.remove('is-visible');
                observer.observe(el);
            });
        }

        // --- SLIDERS ---
        function initializeCardSliders() {
            document.querySelectorAll('[data-slider-id]').forEach(container => {
                const slides = container.querySelectorAll('.slide');
                const dotsContainer = container.querySelector('.dots-container');
                if (!slides.length || !dotsContainer) return;
                
                const dots = dotsContainer.querySelectorAll('.dot');
                let currentSlide = 0;

                function showSlide(n) {
                    if (n >= slides.length) currentSlide = 0;
                    else if (n < 0) currentSlide = slides.length - 1;
                    else currentSlide = n;

                    slides.forEach(slide => {
                        slide.classList.remove('active', 'opacity-100');
                        slide.classList.add('opacity-0');
                        slide.style.zIndex = 0;
                    });
                    slides[currentSlide].classList.add('active', 'opacity-100');
                    slides[currentSlide].classList.remove('opacity-0');
                    slides[currentSlide].style.zIndex = 10;

                    dots.forEach(dot => dot.classList.remove('active'));
                    if (dots[currentSlide]) dots[currentSlide].classList.add('active');
                }

                container.querySelector('.slider-prev').addEventListener('click', (e) => { e.stopPropagation(); showSlide(currentSlide - 1); });
                container.querySelector('.slider-next').addEventListener('click', (e) => { e.stopPropagation(); showSlide(currentSlide + 1); });
                // Optional: Click on image to advance
                // container.addEventListener('click', () => showSlide(currentSlide + 1));
                showSlide(0);
            });
        }
    </script>
</body>
</html>
